<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Advanced Matching | LexOPS Walkthrough</title>
  <meta name="description" content="An introduction to the LexOPS package and how to use it." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Advanced Matching | LexOPS Walkthrough" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="An introduction to the LexOPS package and how to use it." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Advanced Matching | LexOPS Walkthrough" />
  
  <meta name="twitter:description" content="An introduction to the LexOPS package and how to use it." />
  

<meta name="author" content="Jack Taylor" />


<meta name="date" content="2021-02-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="the-generate-pipeline.html"/>
<link rel="next" href="matching-individual-items.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="include/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><b><a href="index.html">LexOPS Walkthrough</a></b></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#useful-links"><i class="fa fa-check"></i>Useful Links</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#what-is-lexops"><i class="fa fa-check"></i><b>1.1</b> What is LexOPS?</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#installation"><i class="fa fa-check"></i><b>1.2</b> Installation</a><ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#installing-r"><i class="fa fa-check"></i>Installing R</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#installing-rstudio"><i class="fa fa-check"></i>Installing RStudio</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#installing-lexops"><i class="fa fa-check"></i>Installing LexOPS</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#the-shiny-app"><i class="fa fa-check"></i><b>1.3</b> The Shiny App</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#the-lexops-dataset"><i class="fa fa-check"></i><b>1.4</b> The LexOPS Dataset</a></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#using-other-datasets"><i class="fa fa-check"></i><b>1.5</b> Using other Datasets</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="the-generate-pipeline.html"><a href="the-generate-pipeline.html"><i class="fa fa-check"></i><b>2</b> The Generate Pipeline</a><ul>
<li class="chapter" data-level="2.1" data-path="the-generate-pipeline.html"><a href="the-generate-pipeline.html#generating-stimuli"><i class="fa fa-check"></i><b>2.1</b> Generating Stimuli</a><ul>
<li class="chapter" data-level="" data-path="the-generate-pipeline.html"><a href="the-generate-pipeline.html#a-practical-example"><i class="fa fa-check"></i>A Practical Example</a></li>
<li class="chapter" data-level="" data-path="the-generate-pipeline.html"><a href="the-generate-pipeline.html#output"><i class="fa fa-check"></i>Output</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="the-generate-pipeline.html"><a href="the-generate-pipeline.html#converting-to-long-format"><i class="fa fa-check"></i><b>2.2</b> Converting to Long Format</a></li>
<li class="chapter" data-level="2.3" data-path="the-generate-pipeline.html"><a href="the-generate-pipeline.html#plotting-the-design"><i class="fa fa-check"></i><b>2.3</b> Plotting the Design</a></li>
<li class="chapter" data-level="2.4" data-path="the-generate-pipeline.html"><a href="the-generate-pipeline.html#checking-representativeness"><i class="fa fa-check"></i><b>2.4</b> Checking Representativeness</a></li>
<li class="chapter" data-level="2.5" data-path="the-generate-pipeline.html"><a href="the-generate-pipeline.html#generating-as-many-as-possible"><i class="fa fa-check"></i><b>2.5</b> Generating as Many as Possible</a></li>
<li class="chapter" data-level="2.6" data-path="the-generate-pipeline.html"><a href="the-generate-pipeline.html#plotting-iterations"><i class="fa fa-check"></i><b>2.6</b> Plotting Iterations</a></li>
<li class="chapter" data-level="2.7" data-path="the-generate-pipeline.html"><a href="the-generate-pipeline.html#custom-dataframes"><i class="fa fa-check"></i><b>2.7</b> Custom Dataframes</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="advanced-matching.html"><a href="advanced-matching.html"><i class="fa fa-check"></i><b>3</b> Advanced Matching</a><ul>
<li class="chapter" data-level="3.1" data-path="advanced-matching.html"><a href="advanced-matching.html#non-stimulus-splits"><i class="fa fa-check"></i><b>3.1</b> Non-Stimulus Splits</a></li>
<li class="chapter" data-level="3.2" data-path="advanced-matching.html"><a href="advanced-matching.html#random-seeds"><i class="fa fa-check"></i><b>3.2</b> Random Seeds</a><ul>
<li><a href="advanced-matching.html#setting-the-seed-in-the-generate-function">Setting the seed in the <code>generate()</code> function</a></li>
<li><a href="advanced-matching.html#setting-the-seed-in-the-split_random-function">Setting the seed in the <code>split_random()</code> function</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="advanced-matching.html"><a href="advanced-matching.html#map-functions-as-controls"><i class="fa fa-check"></i><b>3.3</b> Map Functions as Controls</a><ul>
<li class="chapter" data-level="3.3.1" data-path="advanced-matching.html"><a href="advanced-matching.html#orthographic-similarity"><i class="fa fa-check"></i><b>3.3.1</b> Orthographic Similarity</a></li>
<li class="chapter" data-level="3.3.2" data-path="advanced-matching.html"><a href="advanced-matching.html#phonological-similarity"><i class="fa fa-check"></i><b>3.3.2</b> Phonological Similarity</a></li>
<li class="chapter" data-level="3.3.3" data-path="advanced-matching.html"><a href="advanced-matching.html#other-uses"><i class="fa fa-check"></i><b>3.3.3</b> Other Uses</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="advanced-matching.html"><a href="advanced-matching.html#controlling-for-euclidean-distance"><i class="fa fa-check"></i><b>3.4</b> Controlling for Euclidean Distance</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="matching-individual-items.html"><a href="matching-individual-items.html"><i class="fa fa-check"></i><b>4</b> Matching Individual Items</a><ul>
<li class="chapter" data-level="4.1" data-path="matching-individual-items.html"><a href="matching-individual-items.html#example"><i class="fa fa-check"></i><b>4.1</b> Example</a></li>
<li class="chapter" data-level="4.2" data-path="matching-individual-items.html"><a href="matching-individual-items.html#matching-by-similarity"><i class="fa fa-check"></i><b>4.2</b> Matching by Similarity</a><ul>
<li class="chapter" data-level="4.2.1" data-path="matching-individual-items.html"><a href="matching-individual-items.html#orthographic-similarity-1"><i class="fa fa-check"></i><b>4.2.1</b> Orthographic similarity</a></li>
<li class="chapter" data-level="4.2.2" data-path="matching-individual-items.html"><a href="matching-individual-items.html#phonological-similarity-1"><i class="fa fa-check"></i><b>4.2.2</b> Phonological Similarity</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lexops-shiny-app.html"><a href="lexops-shiny-app.html"><i class="fa fa-check"></i><b>5</b> LexOPS Shiny App</a><ul>
<li class="chapter" data-level="5.1" data-path="lexops-shiny-app.html"><a href="lexops-shiny-app.html#generate"><i class="fa fa-check"></i><b>5.1</b> Generate</a><ul>
<li class="chapter" data-level="5.1.1" data-path="lexops-shiny-app.html"><a href="lexops-shiny-app.html#specify-design"><i class="fa fa-check"></i><b>5.1.1</b> Specify Design</a></li>
<li class="chapter" data-level="5.1.2" data-path="lexops-shiny-app.html"><a href="lexops-shiny-app.html#options"><i class="fa fa-check"></i><b>5.1.2</b> Options</a></li>
<li class="chapter" data-level="5.1.3" data-path="lexops-shiny-app.html"><a href="lexops-shiny-app.html#results"><i class="fa fa-check"></i><b>5.1.3</b> Results</a></li>
<li class="chapter" data-level="5.1.4" data-path="lexops-shiny-app.html"><a href="lexops-shiny-app.html#review"><i class="fa fa-check"></i><b>5.1.4</b> Review</a></li>
<li class="chapter" data-level="5.1.5" data-path="lexops-shiny-app.html"><a href="lexops-shiny-app.html#codify"><i class="fa fa-check"></i><b>5.1.5</b> Codify</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="lexops-shiny-app.html"><a href="lexops-shiny-app.html#match-item"><i class="fa fa-check"></i><b>5.2</b> Match Item</a></li>
<li class="chapter" data-level="5.3" data-path="lexops-shiny-app.html"><a href="lexops-shiny-app.html#fetch"><i class="fa fa-check"></i><b>5.3</b> Fetch</a></li>
<li class="chapter" data-level="5.4" data-path="lexops-shiny-app.html"><a href="lexops-shiny-app.html#visualise"><i class="fa fa-check"></i><b>5.4</b> Visualise</a></li>
<li class="chapter" data-level="5.5" data-path="lexops-shiny-app.html"><a href="lexops-shiny-app.html#custom-variables"><i class="fa fa-check"></i><b>5.5</b> Custom Variables</a></li>
<li class="chapter" data-level="5.6" data-path="lexops-shiny-app.html"><a href="lexops-shiny-app.html#random-seeds-1"><i class="fa fa-check"></i><b>5.6</b> Random Seeds</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="vignettes.html"><a href="vignettes.html"><i class="fa fa-check"></i><b>6</b> Vignettes</a></li>
<li class="chapter" data-level="7" data-path="faq.html"><a href="faq.html"><i class="fa fa-check"></i><b>7</b> FAQ</a><ul>
<li class="chapter" data-level="" data-path="faq.html"><a href="faq.html#how-should-i-cite-lexops"><i class="fa fa-check"></i>How should I cite LexOPS?</a></li>
<li class="chapter" data-level="" data-path="faq.html"><a href="faq.html#what-is-a-match-null"><i class="fa fa-check"></i>What is a “match null”?</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/JackEdTaylor/LexOPS" target="blank"><i class="fa fa-github"></i> LexOPS GitHub</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">LexOPS Walkthrough</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="advanced-matching" class="section level1">
<h1><span class="header-section-number">3</span> Advanced Matching</h1>
<p>There are some cases when the default behaviour of the <code>split_by()</code>, <code>control_for()</code>, and <code>generate()</code> functions won’t quite do what you want. This section presents some extra functions and functionality for generating your matches.</p>
<div id="non-stimulus-splits" class="section level2">
<h2><span class="header-section-number">3.1</span> Non-Stimulus Splits</h2>
<p>Sometimes it makes sense to use independent variables that are not related to features of the stimuli you present. For example, you may be interested in a possible difference between contexts or tasks (such as comparing Word Naming to Lexical Decision). In this case, it makes sense to use a within-subject design, but to present different stimuli in each context. These different stimuli should still be matched across contexts. This is possible with the <code>split_random()</code> function.</p>
<p>As an example, imagine we’re interested in a 2x2 interaction between the effect of words’ arousal ratings before and after a cup of coffee. We use <code>split_random()</code> to say that we want to create a random split in the data with two levels. Such a pipeline might look like this:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="advanced-matching.html#cb11-1"></a>stim &lt;-<span class="st"> </span>lexops <span class="op">%&gt;%</span></span>
<span id="cb11-2"><a href="advanced-matching.html#cb11-2"></a><span class="st">  </span><span class="kw">split_random</span>(<span class="dv">2</span>) <span class="op">%&gt;%</span></span>
<span id="cb11-3"><a href="advanced-matching.html#cb11-3"></a><span class="st">  </span><span class="kw">split_by</span>(AROU.Warriner, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span> <span class="op">~</span><span class="st"> </span><span class="dv">6</span><span class="op">:</span><span class="dv">8</span>) <span class="op">%&gt;%</span></span>
<span id="cb11-4"><a href="advanced-matching.html#cb11-4"></a><span class="st">  </span><span class="kw">control_for</span>(Length, <span class="dv">0</span><span class="op">:</span><span class="dv">0</span>) <span class="op">%&gt;%</span></span>
<span id="cb11-5"><a href="advanced-matching.html#cb11-5"></a><span class="st">  </span><span class="kw">control_for</span>(Zipf.SUBTLEX_UK, <span class="fl">-0.1</span><span class="op">:</span><span class="fl">0.1</span>) <span class="op">%&gt;%</span></span>
<span id="cb11-6"><a href="advanced-matching.html#cb11-6"></a><span class="st">  </span><span class="kw">generate</span>(<span class="dv">50</span>)</span></code></pre></div>
<p>This will create 4 conditions matched for length and frequency, where A1_B1 and A2_B1 are low arousal words, and A1_B2 and A2_B2 are high arousal words. Here are the first 5 items of each condition:</p>
<div class="table">
<table>
<thead>
<tr class="header">
<th align="right">item_nr</th>
<th align="left">A1_B1</th>
<th align="left">A1_B2</th>
<th align="left">A2_B1</th>
<th align="left">A2_B2</th>
<th align="left">match_null</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">panel</td>
<td align="left">snake</td>
<td align="left">bunch</td>
<td align="left">glory</td>
<td align="left">A1_B1</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">cobbler</td>
<td align="left">screech</td>
<td align="left">padding</td>
<td align="left">deathly</td>
<td align="left">A2_B2</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">monogrammed</td>
<td align="left">promiscuity</td>
<td align="left">linguistics</td>
<td align="left">exhilarated</td>
<td align="left">A1_B2</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">hourly</td>
<td align="left">unjust</td>
<td align="left">dismay</td>
<td align="left">payday</td>
<td align="left">A1_B1</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">rectangular</td>
<td align="left">heartbroken</td>
<td align="left">therapeutic</td>
<td align="left">stimulating</td>
<td align="left">A2_B2</td>
</tr>
</tbody>
</table>
</div>
<p>These stimuli could then be used in combination with a counter-balanced design, alternating which level of B has its stimuli presented before the coffee, and which after. Note that the <code>split_random()</code> function will also need its own <a href="advanced-matching.html#random-seeds">random seed</a> (<code>seed = ...</code>) to replicate a specific stimulus list.</p>
</div>
<div id="random-seeds" class="section level2">
<h2><span class="header-section-number">3.2</span> Random Seeds</h2>
<p>By default, the generate pipeline will produce novel stimulus lists each time it is run. Often you’ll want your code to be reproducible, however. To do this, we can use a random seed.</p>
<p>Random seeds allow for replicable results from functions that produce different results each time they are run. In R, this is usually done with the <code>set.seed()</code> function. The <code>set.seed()</code> function can be used with LexOPS to write reproducible pipelines, <strong>but</strong> will yield different results between LexOPS R code and the <a href="lexops-shiny-app.html">LexOPS shiny app</a>, and might produce different results between versions. To ensure that pipelines created with R code can be reproduced in the shiny app (and <a href="lexops-shiny-app.html#random-seeds">vice versa</a>), and across different versions, it is recommended to use the <code>seed</code> argument of the <code>generate()</code> function.</p>
<div id="setting-the-seed-in-the-generate-function" class="section level3 unnumbered">
<h3>Setting the seed in the <code>generate()</code> function</h3>
<p>The following code will generate the same stimulus list each time it is run:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="advanced-matching.html#cb12-1"></a>stim &lt;-<span class="st"> </span>lexops <span class="op">%&gt;%</span></span>
<span id="cb12-2"><a href="advanced-matching.html#cb12-2"></a><span class="st">  </span><span class="kw">subset</span>(PK.Brysbaert <span class="op">&gt;=</span><span class="st"> </span><span class="fl">0.9</span>) <span class="op">%&gt;%</span></span>
<span id="cb12-3"><a href="advanced-matching.html#cb12-3"></a><span class="st">  </span><span class="kw">split_by</span>(CNC.Brysbaert, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span> <span class="op">~</span><span class="st"> </span><span class="dv">4</span><span class="op">:</span><span class="dv">5</span>) <span class="op">%&gt;%</span></span>
<span id="cb12-4"><a href="advanced-matching.html#cb12-4"></a><span class="st">  </span><span class="kw">split_by</span>(BG.SUBTLEX_UK, <span class="dv">0</span><span class="op">:</span><span class="fl">0.003</span> <span class="op">~</span><span class="st"> </span><span class="fl">0.009</span><span class="op">:</span><span class="fl">0.013</span>) <span class="op">%&gt;%</span></span>
<span id="cb12-5"><a href="advanced-matching.html#cb12-5"></a><span class="st">  </span><span class="kw">control_for</span>(Length, <span class="dv">0</span><span class="op">:</span><span class="dv">0</span>) <span class="op">%&gt;%</span></span>
<span id="cb12-6"><a href="advanced-matching.html#cb12-6"></a><span class="st">  </span><span class="kw">control_for</span>(Zipf.SUBTLEX_UK, <span class="fl">-0.2</span><span class="op">:</span><span class="fl">0.2</span>) <span class="op">%&gt;%</span></span>
<span id="cb12-7"><a href="advanced-matching.html#cb12-7"></a><span class="st">  </span><span class="kw">generate</span>(<span class="dv">25</span>, <span class="dt">seed =</span> <span class="dv">42</span>)</span></code></pre></div>
</div>
<div id="setting-the-seed-in-the-split_random-function" class="section level3 unnumbered">
<h3>Setting the seed in the <code>split_random()</code> function</h3>
<p>If you use the <code>split_random()</code> function, this will also require a <code>seed</code> argument in order for the pipeline to be reproducible. This does not necessarily need to be the same as the <code>seed</code> value passed to <code>generate()</code>, but the shiny app will assume this is the case when <a href="lexops-shiny-app.html#codify">translating Shiny options into R code</a>. The following is an example of a reproducible pipeline that uses the <code>split_random()</code> function:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="advanced-matching.html#cb13-1"></a>my_seed &lt;-<span class="st"> </span><span class="dv">42</span></span>
<span id="cb13-2"><a href="advanced-matching.html#cb13-2"></a></span>
<span id="cb13-3"><a href="advanced-matching.html#cb13-3"></a>stim &lt;-<span class="st"> </span>lexops <span class="op">%&gt;%</span></span>
<span id="cb13-4"><a href="advanced-matching.html#cb13-4"></a><span class="st">  </span><span class="kw">split_random</span>(<span class="dv">2</span>, <span class="dt">seed =</span> my_seed) <span class="op">%&gt;%</span></span>
<span id="cb13-5"><a href="advanced-matching.html#cb13-5"></a><span class="st">  </span><span class="kw">split_by</span>(AROU.Warriner, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span> <span class="op">~</span><span class="st"> </span><span class="dv">6</span><span class="op">:</span><span class="dv">8</span>) <span class="op">%&gt;%</span></span>
<span id="cb13-6"><a href="advanced-matching.html#cb13-6"></a><span class="st">  </span><span class="kw">control_for</span>(Length, <span class="dv">0</span><span class="op">:</span><span class="dv">0</span>) <span class="op">%&gt;%</span></span>
<span id="cb13-7"><a href="advanced-matching.html#cb13-7"></a><span class="st">  </span><span class="kw">control_for</span>(Zipf.SUBTLEX_UK, <span class="fl">-0.1</span><span class="op">:</span><span class="fl">0.1</span>) <span class="op">%&gt;%</span></span>
<span id="cb13-8"><a href="advanced-matching.html#cb13-8"></a><span class="st">  </span><span class="kw">generate</span>(<span class="dv">50</span>, <span class="dt">seed =</span> my_seed)</span></code></pre></div>
</div>
</div>
<div id="map-functions-as-controls" class="section level2">
<h2><span class="header-section-number">3.3</span> Map Functions as Controls</h2>
<p>Imagine you want to generate a list of stimuli, controlling for a value of similarity to the match null. This would be very difficult using the <code>control_for()</code> function. The problem is that the similarity values would need to be calculated <em>n</em> times, relative each word currently being used as a match null. The <code>control_for_map()</code> function tells LexOPS to recalculate the value to use as a control on each iteration of the <code>generate()</code> function, relative to a value associated with the string currently selected as a match null.</p>
<p>Example applications for this include controlling for orthographic or phonological similarity.</p>
<div id="orthographic-similarity" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Orthographic Similarity</h3>
<p>Here is an example, using <code>control_for_map()</code> to control for orthographic Levenshtein distance from the match null (calculated using the <code>vwr</code> package). This means that each string will be a distance of between 0 and 3 character insertions, deletions or replacements from the word used as the match null.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="advanced-matching.html#cb14-1"></a><span class="kw">library</span>(vwr)</span>
<span id="cb14-2"><a href="advanced-matching.html#cb14-2"></a></span>
<span id="cb14-3"><a href="advanced-matching.html#cb14-3"></a>stim &lt;-<span class="st"> </span>lexops <span class="op">%&gt;%</span></span>
<span id="cb14-4"><a href="advanced-matching.html#cb14-4"></a><span class="st">  </span><span class="kw">split_by</span>(VAL.Warriner, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span> <span class="op">~</span><span class="st"> </span><span class="fl">4.5</span><span class="op">:</span><span class="fl">5.5</span> <span class="op">~</span><span class="st"> </span><span class="dv">7</span><span class="op">:</span><span class="dv">9</span>) <span class="op">%&gt;%</span></span>
<span id="cb14-5"><a href="advanced-matching.html#cb14-5"></a><span class="st">  </span><span class="kw">control_for_map</span>(levenshtein.distance, string, <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">name=</span><span class="st">&quot;Orth_Dist&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb14-6"><a href="advanced-matching.html#cb14-6"></a><span class="st">  </span><span class="kw">generate</span>(<span class="dv">20</span>)</span></code></pre></div>
<p>Here are the first 5 items of each condition that we generated. Note that we have 3 levels of valence, with matched items that are orthographically similar to one another:</p>

<div class="table">
<table>
<thead>
<tr class="header">
<th align="right">item_nr</th>
<th align="left">A1</th>
<th align="left">A2</th>
<th align="left">A3</th>
<th align="left">match_null</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">sting</td>
<td align="left">stint</td>
<td align="left">sing</td>
<td align="left">A1</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">germ</td>
<td align="left">hem</td>
<td align="left">gem</td>
<td align="left">A3</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">sad</td>
<td align="left">pad</td>
<td align="left">dad</td>
<td align="left">A1</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">slap</td>
<td align="left">swap</td>
<td align="left">soap</td>
<td align="left">A3</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">shun</td>
<td align="left">shin</td>
<td align="left">shine</td>
<td align="left">A2</td>
</tr>
</tbody>
</table>
</div>

<br>
<div class="info">
<p>
The name argument (<code>name = …</code>) of the <code>control_for_map()</code> function will simply specify the name of the column that the calculated values should be stored as when the stimuli are in long format (from the code above, <code>long_format(stim)</code> will contain a column called “Orth_Dist”, containing the orthographic distances from the match null).
</p>
</div>
<p><br></p>
</div>
<div id="phonological-similarity" class="section level3">
<h3><span class="header-section-number">3.3.2</span> Phonological Similarity</h3>
<p>We can use a similar pipeline to match by phonological similarity. Instead of giving the string column to the function, we just have to give a column where phonemes are represented by single letters. All the generated stimuli will be within a distance of between 0 and 2 phonemic insertions, deletions, or substitutions from the word used as the match null. For fun (and to show how <code>control_for_map()</code> can be combined with <code>control_for()</code>), let’s also control for rhyme.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="advanced-matching.html#cb15-1"></a><span class="kw">library</span>(vwr)</span>
<span id="cb15-2"><a href="advanced-matching.html#cb15-2"></a></span>
<span id="cb15-3"><a href="advanced-matching.html#cb15-3"></a>stim &lt;-<span class="st"> </span>lexops <span class="op">%&gt;%</span></span>
<span id="cb15-4"><a href="advanced-matching.html#cb15-4"></a><span class="st">  </span><span class="kw">split_by</span>(VAL.Warriner, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span> <span class="op">~</span><span class="st"> </span><span class="fl">4.5</span><span class="op">:</span><span class="fl">5.5</span> <span class="op">~</span><span class="st"> </span><span class="dv">7</span><span class="op">:</span><span class="dv">9</span>) <span class="op">%&gt;%</span></span>
<span id="cb15-5"><a href="advanced-matching.html#cb15-5"></a><span class="st">  </span><span class="kw">control_for_map</span>(levenshtein.distance, eSpeak.br_1letter, <span class="dv">0</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">name=</span><span class="st">&quot;Phon_Dist&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb15-6"><a href="advanced-matching.html#cb15-6"></a><span class="st">  </span><span class="kw">control_for</span>(Rhyme.eSpeak.br) <span class="op">%&gt;%</span></span>
<span id="cb15-7"><a href="advanced-matching.html#cb15-7"></a><span class="st">  </span><span class="kw">generate</span>(<span class="dv">20</span>)</span></code></pre></div>
<p>Here are the first 5 items of each condition that we generated. This time, all matched items are phonologically similar to one another:</p>

<div class="table">
<table>
<thead>
<tr class="header">
<th align="right">item_nr</th>
<th align="left">A1</th>
<th align="left">A2</th>
<th align="left">A3</th>
<th align="left">match_null</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">slave</td>
<td align="left">cave</td>
<td align="left">save</td>
<td align="left">A3</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">arson</td>
<td align="left">jargon</td>
<td align="left">garden</td>
<td align="left">A2</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">asthma</td>
<td align="left">llama</td>
<td align="left">aroma</td>
<td align="left">A1</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">sad</td>
<td align="left">pad</td>
<td align="left">dad</td>
<td align="left">A2</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">fee</td>
<td align="left">tee</td>
<td align="left">free</td>
<td align="left">A3</td>
</tr>
</tbody>
</table>
</div>

</div>
<div id="other-uses" class="section level3">
<h3><span class="header-section-number">3.3.3</span> Other Uses</h3>
<p>The <code>control_for_map()</code> function can be used to control for any variable that needs to be calculated relative to the match null. The <code>fun</code> argument of <code>control_for_map()</code> should be a function that takes the data in the column contained in <code>var</code> as its first argument, and can take the match null’s value for <code>var</code> as the second argument, to return a vector of values for each entry. In addition, <code>tol</code> can be specified as it is in <code>control_for()</code>, as either a numeric tolerance, or categorical tolerance if the function outputs character vectors. The <code>name</code> argument should just be a character vector to name the column in the long format of the generated stimuli.</p>
<p>If you’re wanting to use <code>control_for_map()</code> on your own function or data, see this <a href="vignettes/control_for_map.html">vignette on controlling for semantic relatedness</a>. The function’s documentation in the package (<a href="https://rdrr.io/github/JackEdTaylor/LexOPS/man/control_for_map.html"><code>?control_for_map</code></a>) might also be useful. Additionally, you may want to look at <a href="https://cran.r-project.org/web/packages/vwr/vwr.pdf">how the vwr functions work</a> for comparison, as <code>control_for_map()</code> was originally written with these in mind.</p>
</div>
</div>
<div id="controlling-for-euclidean-distance" class="section level2">
<h2><span class="header-section-number">3.4</span> Controlling for Euclidean Distance</h2>
<p>The <code>control_for()</code> function lets you give specific tolerances for individual variables. Another method of matching items, however, may be to control for Euclidean distance, weighting variables by their relative importance. The <code>control_for_euc()</code> function lets you do exactly this. As an example, imagine we want to split by concretness, and control for length, frequency, and age of acquisition. We might decide that length is the most important thing to match (ideally exact matching), followed by frequency and age of acquisition. This could be achieved like so:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="advanced-matching.html#cb16-1"></a>stim &lt;-<span class="st"> </span>lexops <span class="op">%&gt;%</span></span>
<span id="cb16-2"><a href="advanced-matching.html#cb16-2"></a><span class="st">    </span><span class="kw">split_by</span>(CNC.Brysbaert, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span> <span class="op">~</span><span class="st"> </span><span class="dv">4</span><span class="op">:</span><span class="dv">5</span>) <span class="op">%&gt;%</span></span>
<span id="cb16-3"><a href="advanced-matching.html#cb16-3"></a><span class="st">    </span><span class="kw">control_for_euc</span>(</span>
<span id="cb16-4"><a href="advanced-matching.html#cb16-4"></a>        <span class="kw">c</span>(Length, Zipf.BNC.Written, AoA.Kuperman),</span>
<span id="cb16-5"><a href="advanced-matching.html#cb16-5"></a>        <span class="dv">0</span><span class="op">:</span><span class="fl">1e-5</span>,</span>
<span id="cb16-6"><a href="advanced-matching.html#cb16-6"></a>        <span class="dt">name =</span> <span class="st">&quot;euclidean_distance&quot;</span>,</span>
<span id="cb16-7"><a href="advanced-matching.html#cb16-7"></a>        <span class="dt">weights =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">0.5</span>, <span class="fl">0.05</span>)</span>
<span id="cb16-8"><a href="advanced-matching.html#cb16-8"></a>    ) <span class="op">%&gt;%</span></span>
<span id="cb16-9"><a href="advanced-matching.html#cb16-9"></a><span class="st">    </span><span class="kw">generate</span>(<span class="dv">20</span>)</span></code></pre></div>
<p>This method will generally be slower than standard LexOPS pipelines, but more flexible. You can also combine <code>control_for_euc()</code> and <code>control_for()</code> functions in your pipelines. For more information on controlling for Euclidean distance, and how to decide on tolerances, try the <a href="https://jackedtaylor.github.io/LexOPSdocs/vignettes/euclidean-distance.html">vignette on Euclidean distance</a>.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="the-generate-pipeline.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="matching-individual-items.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"],
"google": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": {},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

</body>

</html>
